{% assign current_url = page.url | default: "/" %}

{% assign top_item = nil %}
{% assign child_item = nil %}

{% for item in site.data.navigation.main %}
  {% assign item_clean = item.url | default:"/" | split:"#": | first %}

  {% if current_url == item_clean or current_url contains item_clean %}
    {% assign top_item = item %}
  {% endif %}

  {% if item.children %}
    {% for child in item.children %}
      {% assign child_clean = child.url | split:"#": | first %}
      {% if current_url == child_clean or current_url contains child_clean %}
        {% assign top_item = item %}
        {% assign child_item = child %}
      {% endif %}
    {% endfor %}
  {% endif %}
{% endfor %}

{% unless current_url == "/" %}
<nav class="forge-breadcrumbs" aria-label="Breadcrumb">
  <a href="/">Home</a>

  {% if top_item and top_item.url != "/" %}
    <span class="forge-breadcrumbs-separator">/</span>
    <a href="{{ top_item.url }}">{{ top_item.title }}</a>
  {% endif %}

  {% if child_item %}
    <span class="forge-breadcrumbs-separator">/</span>
    <span class="forge-breadcrumbs-current">{{ child_item.title }}</span>
  {% endif %}
</nav>
{% endunless %}